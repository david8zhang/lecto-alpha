<html>
	<style>
		.hidden{
			visibility:hidden;
		}
		#remoteVideos {
			opacity: 0;
		}

		li{
			margin-top: 10px;
		}

		.body{
			background-color:#B6C5D5;
		}

		#localvideo{
			margin:5px;
			border: 0 solid #333;
			border-top: 15px solid #333;
			border-bottom: 15px solid #333;
			border-left: 15px solid #333;
			border-right: 15px solid #333;
		}

		.navbar {
			box-shadow: 0 5px 5px #333;
		}

	</style>
	<head>
		<!-- Boostrap components -->
        <link href="https://bootswatch.com/flatly/bootstrap.min.css" rel="stylesheet">
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
		<script type="text/javascript" src="/adapter.js"></script>
		<script src="/latest.js"></script>


		<meta name="keywords" content="JavaScript, WebRTC" />
		<meta name="description" content="WebRTC codelab" />
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1">

		<nav class="navbar navbar-default navbar-fixed-top">
			<div class="container">
				<form id="postform" class="hidden" action="/dashboard" method="post">
					<input type="text" name="username" id="username">
				</form>
				<a href="#" class="navbar-brand">Teach</a>
				<ul class="nav nav-pills">
					<li role="presentation"><a href="#" onclick="redirect()"><b>End Session</b></a></li>
				</ul>
			</div>
		</nav>	
	</head>

	<body class="text-center body">
		<br>
		<br>
		<br>
		<div class="container">
			<div id='videos'>
				<video id='localVideo' autoplay></video>
				<div id="remoteVideos"></div>
			</div>	
		</div>
		

		<div class="hidden" id="keyholder"><%=sessionid%></div>
		<div class="container">
			<div class="panel panel-default">
				<div class="panel-heading">
					<h1><%=title%></h1>
					<h3><%=subject%></h3>
				</div>
				<div class="panel-body">
					<p>The price for video/premium on this lecture is $<%=price%></p>
				</div>
			</div>
		</div>

	</body>

	<script>
		var sessID = document.getElementById("keyholder").innerHTML;
		console.log(sessID);
		var webrtc = new SimpleWebRTC({
			localVideoEl: 'localVideo',
			autoRequestMedia: true
		});

		webrtc.on('readyToCall', function () {
			webrtc.joinRoom(sessID);
		});

		function redirect(){
			var form = document.getElementById("postform");
			var username = document.getElementById("username");
			username.value = sessID.substring(sessID.indexOf(" ") + 1);
			form.submit();
		}
	</script>

</html>